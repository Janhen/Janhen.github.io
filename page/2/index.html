<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Janhen</title><meta name="author" content="Janhen"><meta name="copyright" content="Janhen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="大数据、后端、运维分享">
<meta property="og:type" content="website">
<meta property="og:title" content="Janhen">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Janhen">
<meta property="og:description" content="大数据、后端、运维分享">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://img.janhen.com/20210331220602f7HmbN.pnghttp://img.janhen.com/20210331220602f7HmbN.png">
<meta property="article:author" content="Janhen">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://img.janhen.com/20210331220602f7HmbN.pnghttp://img.janhen.com/20210331220602f7HmbN.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/page/2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-05-07 15:54:27'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Janhen" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="http://img.janhen.com/20210331220602f7HmbN.pnghttp://img.janhen.com/20210331220602f7HmbN.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">47</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">21</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div></div></div><hr/></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Janhen</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Janhen</h1></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/04/09/SparkCore-RDD-%E7%BC%96%E7%A8%8B/" title="SparkCore-RDD-编程">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SparkCore-RDD-编程"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/09/SparkCore-RDD-%E7%BC%96%E7%A8%8B/" title="SparkCore-RDD-编程">SparkCore-RDD-编程</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-09T08:50:21.000Z" title="Created 2021-04-09 16:50:21">2021-04-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Spark/">Spark</a></span></div><div class="content">RDD 概述
分布式弹性数据集，是Spark 中的核心概念，是一个有容错机制的特殊数据集，可分布在集群中的节点上，以函数式操作集合的方式进行各种操作，所有算子都基于 RDD 执行。

RDD 执行的过程中会形成 DAG 图，然后形成 Lineage 保证容错性。
物理角度看，RDD 存储的是 block 和 node 之间的映射。
不支持增量迭代计算，Flink 支持。
基本组成RDD 的组成：

一个分区列表，每个分区是 RDD 中的部分数据
一个名为 compute 的计算函数，用于计算 RDD 各分区的值
一个依赖列表，存储依赖的其他 RDD，记录数据的血缘关系，用于数据的恢复
可选的分区器，用于键值类型的 RDD, 如某个 RDD 按照散列分区
可选的计算各分区时的优先位置列表，如从 HDFS 中的文件生成 RDD 时，RDD 分区的位置优先选择数据所在的节点，避免数据移动带来的开销

RDD 的特点：

弹性：默认情况下存储在内存中，内存不足时，可存储在磁盘上
分区： 逻辑上分区，每个分区数据抽象存在的
依赖： RDD 算子进行转换，转换得到的 RDD 保存了从其他 RDDs ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/04/09/Spark-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B8%8E%E6%8C%81%E4%B9%85%E5%8C%96/" title="Spark-内存管理与持久化">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spark-内存管理与持久化"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/09/Spark-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B8%8E%E6%8C%81%E4%B9%85%E5%8C%96/" title="Spark-内存管理与持久化">Spark-内存管理与持久化</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-09T07:10:07.000Z" title="Created 2021-04-09 15:10:07">2021-04-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Spark/">Spark</a></span></div><div class="content">内存管理静态内存管理
Spark 2.0 以前版本采用静态内存管理机制。存储内存、执行内存和其他内存的大小在 Spark 应用程序运行期间均为固定的。 容易造成存储内存和执行内存中的一方剩余大量的空间，而另一方却早早被占满，不得不淘汰或移出旧的内容以存储新的内容。目前已经被淘汰。
统一内存管理
Spark 2.0 之后引入统一内存管理机制，存储内存和执行内存共享同一块空间，可以动态占用对方的空闲区域，统一内存管理的堆内内存结构。
可以借用内存
最重要的优化在于动态占用机制
在执行过程中：执行内存的优先级 &gt; 存储内存的优先级
凭借统一内存管理机制，Spark 在一定程度上提高了堆内和堆外内存资源的利用率， 降低了开发者维护 Spark 内存的难度
存储内存管理RDD 持久化机制
Task 在启动之初读取一个分区时：

先判断这个分区是否已经被持久化
如果没有则需要检查 Checkpoint 或按照血统重新计算。

RDD 的持久化由 Spark 的 Storage(BlockManager) 模块负责，实现了 RDD 与物理存储的解耦合。
Storage 模块在逻辑上以 Bloc ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/04/09/Spark-%E7%AE%A1%E7%90%86/" title="Spark-管理">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spark-管理"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/09/Spark-%E7%AE%A1%E7%90%86/" title="Spark-管理">Spark-管理</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-09T05:52:17.000Z" title="Created 2021-04-09 13:52:17">2021-04-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Spark/">Spark</a></span></div><div class="content">命令操作命令参数：

–-class： 指定运行的入口类

--master
：Standalone 模式时指定集群地址，yarn 模式时指定为 yarn，

–-deploy-mode：运行模式，client 代表 yarn-client，cluster 代表 yarn-cluster



资源分配参数：

--num-executors 2: 指定多少个 executor 进程进行执行
--total-executor-cores: 总的核心数量
--executor-memory=1G: 每个 executor 使用的内存, PROD 中可以设置为2~4G即可
--executor-cores 2： 每个 executor 分配的 CPU
--driver-memory 1G: 设置 Driver 进程的内存，使用类似于 collect 之类的 action 算子向 Driver 端拉取数据时，需要调大
--driver-cores 1: driver 进程分配多少 core，默认为 1

覆盖运行的配置参数：

–conf：指定运行时候的配置
spark.default.pa ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/04/09/Spark-%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6%E5%92%8C%E4%BD%9C%E4%B8%9A%E6%89%A7%E8%A1%8C/" title="Spark-运行机制和作业执行">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spark-运行机制和作业执行"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/09/Spark-%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6%E5%92%8C%E4%BD%9C%E4%B8%9A%E6%89%A7%E8%A1%8C/" title="Spark-运行机制和作业执行">Spark-运行机制和作业执行</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-09T05:52:17.000Z" title="Created 2021-04-09 13:52:17">2021-04-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Spark/">Spark</a></span></div><div class="content">运行机制和作业执行执行过程spark-submit可指定 Spark 运行时资源配置，一般根据作业的性质配置适当的 Executor 的内存和 cpu cores，之后由调度系统(airflow, azkaban 等) 进行周期性的调度执行。
命令参数：

--master MASTER_URL：

Standalone 模式时指定集群地址(spark://host:port)

yarn 模式时指定为 yarn
local 指定为 local, local[N], local[*]
mesos 模式指定地址 mesos://host:port


–-class： 指定运行的入口类(Driver)

–-deploy-mode：运行模式，决定了 driver 的运行方式，默认为 client

--name: 应用名称

--num-executors 2: 指定多少个 executor 进程进行执行

--total-executor-cores: 总的 executor 核心数量

--executor-memory=3G: 每个 executor 使用的内存, PROD 中可以 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/04/09/Spark-SparkContext%E4%B8%8E%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/" title="Spark-Master与Worker和SparkContext">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spark-Master与Worker和SparkContext"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/09/Spark-SparkContext%E4%B8%8E%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/" title="Spark-Master与Worker和SparkContext">Spark-Master与Worker和SparkContext</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-08T18:05:42.000Z" title="Created 2021-04-09 02:05:42">2021-04-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Spark/">Spark</a></span></div><div class="content">Master 与 Worker 解析RPC 框架Spark 中不同组件之间的通信、jar 的上传、Shuffle 数据的传输、Block 数据的复制与备份都是基于 RPC 来实现的。

RpcEndpoint： 表示一个消息通信体，可以接收、发送、处理消息。
construct: 构造器
onStart：启动
receive*: 用来接收RpcEndpoint send 或 ask 过来的消 息
receive: 接收由RpcEndpointRef.send方法发送的消息，不需要立即处理
receiveAndReply: 接受消息并回复。接收由RpcEndpointRef.ask发送的消息，需要立即处理


onStop：资源回收


RpcEnv： 管理着整个 RpcEndpoint 的生命周期
根据name或uri注册endpoints、管理各种消息的处理、停止endpoints。


RpcEndpointRef: 对远程 RpcEndpoint 的一个引用。当需要向一个具体的 RpcEndpoint 发送消息时，需要获取到该 RpcEndpoint 的引用，然后通过该引用发送消 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/04/09/MySQL-%E7%AE%A1%E7%90%86/" title="MySQL-管理">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL-管理"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/09/MySQL-%E7%AE%A1%E7%90%86/" title="MySQL-管理">MySQL-管理</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-08T17:10:05.000Z" title="Created 2021-04-09 01:10:05">2021-04-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/MySQL/">MySQL</a></span></div><div class="content">基本管理查看数据库中行数大于 0 的表
1234567891011121314151617181920-- 查找表行大于0的SELECT CONCAT(table_schema, &#x27;.&#x27;, table_name)                    AS  TABLE_NAME      ,engine                                                   AS  TABLE_ENGINE       ,table_type                                               AS  TABLE_TYPE      ,table_rows                                               AS  TABLE_ROWS      ,CONCAT(ROUND(data_length  / ( 1024 * 1024), 2), &#x27;M&#x27;)     AS  TB_DATA_SIZE       ,CONCAT(ROUND(in ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/04/09/MySQL-%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/" title="MySQL-备份与恢复">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL-备份与恢复"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/09/MySQL-%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/" title="MySQL-备份与恢复">MySQL-备份与恢复</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-08T17:06:57.000Z" title="Created 2021-04-09 01:06:57">2021-04-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/MySQL/">MySQL</a></span></div><div class="content">备份概述
备份决定了数据库的安全，在主从不一致的情况下删除从库的所有数据，进行数据重新整理。

对于 MyISAM 备份
1FLUSH TABLES WITH READ LOCK;

备份策略逻辑备份： 结果为 sql 文件，方法适用于所有 Engine
物理备份： 数据库目录的拷贝，对于内存表只备份结构
备份的内容：

事务的 innodb 表，不带有事务的(无法保证一致性)
函数(routines)、触发器、视图
包含的表，有时无需对整个数据库所有的表进行备份，只需要备份重要的业务表，用于以后的恢复
排除的表，在做全量备份的时候，排除掉日志表、记录表、备份表等与业务非强相关的表，提高备份的效率

备份的类型：

热备份： 在线备份，不需要任何的服务停机时间，ibbackup 商业工具可实现
冷备份： 备份 .frm, .idb 文件，需要离线备份
温备份： 非离线备份，在线执行，会影响线上的数据库运行

备份的方案:

全量备份
增量备份
压缩备份
加密备份

备份的数据存放到另一块物理磁盘上或是传输到另一台机器上
12345678910SELECT data INTO OUTFI ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/04/09/Mysql-%E6%97%A5%E5%BF%97/" title="Mysql-日志">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mysql-日志"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/09/Mysql-%E6%97%A5%E5%BF%97/" title="Mysql-日志">Mysql-日志</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-08T17:06:49.000Z" title="Created 2021-04-09 01:06:49">2021-04-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/MySQL/">MySQL</a></span></div><div class="content">慢查询日志
MySQL 的动态参数，可以随关随停

慢查询优化优化策略：

调优 TOP10, 之后迭代…
业务扩展，用户流量增加，进一步调优

慢查询日志的性能剖析工具：汇总一些信息，自动排序
查看慢日志：
正常的格式
explain
EXPLAIN 关键字模拟优化器执行 SQL 查询语句

12345explain select 		  	 star, 			 	 evaluator_no from indicator_evaluate order by evaluator_no desc;


id: 代表执行的顺序
type: 找到数据行的方式, 数据的访问类型，取值为如下
all: 全表扫描
index: ALL 和 INDEX 都读全表，INDEX 从索引读， ALL 从硬盘读
range： between, in, &gt;, &lt; 等的查询，无需扫全表
ref：非唯一性索引扫描，返回匹配..
eq_ref: 唯一性索引扫描，对于每一个索引键，表中只有一条记录与之匹配。常见于主键或者唯一索引扫描。
const: 表示通过索引一次就找到了，const 用于比较为 pri ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/04/09/MySQL-%E7%BB%93%E6%9E%84%E7%B4%A2%E5%BC%95%E4%B8%8ESQL%E4%BC%98%E5%8C%96/" title="MySQL-结构索引与SQL优化">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL-结构索引与SQL优化"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/09/MySQL-%E7%BB%93%E6%9E%84%E7%B4%A2%E5%BC%95%E4%B8%8ESQL%E4%BC%98%E5%8C%96/" title="MySQL-结构索引与SQL优化">MySQL-结构索引与SQL优化</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-08T17:06:14.000Z" title="Created 2021-04-09 01:06:14">2021-04-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/MySQL/">MySQL</a></span></div><div class="content">MySQL 结构优化结构设计

过分的反范式化为表建立太多的列
过分的范式化造成太多的表关联
在 OLTP 环境中使用不恰当的分区表
使用外键保证数据的完整性

性能优化顺序

数据库结构设计和SQL语句
数据库存储引擎的选择和参数配置
系统选择及优化
硬件升级

知道常用的数据类型，数据库的范式和反范式，各种字段类型占据的大小，更改字段类型是否锁表，如何处理分布式系统下字段的更改。
1、数据库优化的目的

减少数据冗余，节约数据存储空间
提高查询效率
避免数据维护中的异常：
插入异常： 必须有什么才能有什么
更新异常： 如果更改表中的某个实体的单独属性时，需要对多行进行更新
删除异常： 如果删除表中的某一实体则会导致其他实体的消失



2、数据库结构设计步骤 (1) 需求分析： (2) 逻辑设计: 确定数据实体之间的逻辑关系，逻辑存储结构 (3) 物理设计： 跟据所使用的数据库特点进行表结构设计 (4) 维护优化： 维护好索引
范式与反范式1、数据库设计范式 (1) 1NF (2) 2NF： 要求一个表中只具有一个业务主键，符合第二范式的表中不存在非主键列，只对部分主键的依赖关系  ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/04/09/MySql-%E7%B4%A2%E5%BC%95/" title="MySql-索引">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySql-索引"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/09/MySql-%E7%B4%A2%E5%BC%95/" title="MySql-索引">MySql-索引</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-08T17:06:02.000Z" title="Created 2021-04-09 01:06:02">2021-04-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/MySQL/">MySQL</a></span></div><div class="content">概述删除长期未使用的索引 不用的索引的存在会造成不必要的性能损耗 MySQL 5.7 可以通过查询 sys 库的 chema_unused_indexes 视图来查询哪些索引从未被使用
避免定义重复的索引
借助 pt-duplicate-key-checker 查找，并生成删除重复索引的 SQL 语句
1pt-duplicate-key-checker -h &lt;host&gt; -u&lt;user&gt; -p&lt;passwd&gt;

索引好处：

提高访问速度；
优化查询；
将随机 IO 改为顺序 IO

索引缺点：

占用空间，索引建立的越多越占用空间；
更改频繁时，每次修改都需要重建索引；

索引的适用场景

选择性较高的场景；

不适合索引的场景：

数据规模小的情况；
选择性较低的列；

索引的底层实现

Hash 索引

适⽤于只有等值查询的场景，⽐如 Memcached 及其他⼀些 NoSQL 引擎。
(2)) 有序数组
有序数组在等值查询和范围查询场景中的性能就都⾮常优秀, 有序数组索引只适⽤于静态存储引擎。

二叉树
B+ 树

索引的创建
index_ ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/#content-inner">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/#content-inner">5</a><a class="extend next" rel="next" href="/page/3/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="http://img.janhen.com/20210331220602f7HmbN.pnghttp://img.janhen.com/20210331220602f7HmbN.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Janhen</div><div class="author-info__description">大数据、后端、运维分享</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">47</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">21</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Janhen"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/05/07/Spark-%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C/" title="Spark-数据倾斜"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spark-数据倾斜"/></a><div class="content"><a class="title" href="/2021/05/07/Spark-%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C/" title="Spark-数据倾斜">Spark-数据倾斜</a><time datetime="2021-05-07T07:45:41.000Z" title="Created 2021-05-07 15:45:41">2021-05-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/05/Spark-Shuffle%E8%BF%87%E7%A8%8B/" title="Spark-Shuffle 过程和原理"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spark-Shuffle 过程和原理"/></a><div class="content"><a class="title" href="/2021/05/05/Spark-Shuffle%E8%BF%87%E7%A8%8B/" title="Spark-Shuffle 过程和原理">Spark-Shuffle 过程和原理</a><time datetime="2021-05-05T08:55:56.000Z" title="Created 2021-05-05 16:55:56">2021-05-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/05/Spark-SQL%E4%B8%ADJoin%E7%9A%84%E5%AE%9E%E7%8E%B0/" title="Spark-Join的原理"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spark-Join的原理"/></a><div class="content"><a class="title" href="/2021/05/05/Spark-SQL%E4%B8%ADJoin%E7%9A%84%E5%AE%9E%E7%8E%B0/" title="Spark-Join的原理">Spark-Join的原理</a><time datetime="2021-05-05T08:29:59.000Z" title="Created 2021-05-05 16:29:59">2021-05-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/22/Hadoop-MapReduce-%E8%AE%A1%E7%AE%97%E5%BC%95%E6%93%8E/" title="Hadoop-MapReduce-计算引擎"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hadoop-MapReduce-计算引擎"/></a><div class="content"><a class="title" href="/2021/04/22/Hadoop-MapReduce-%E8%AE%A1%E7%AE%97%E5%BC%95%E6%93%8E/" title="Hadoop-MapReduce-计算引擎">Hadoop-MapReduce-计算引擎</a><time datetime="2021-04-22T05:22:45.000Z" title="Created 2021-04-22 13:22:45">2021-04-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/22/Hadoop-HDFS-%E5%AD%98%E5%82%A8/" title="Hadoop-HDFS-存储"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hadoop-HDFS-存储"/></a><div class="content"><a class="title" href="/2021/04/22/Hadoop-HDFS-%E5%AD%98%E5%82%A8/" title="Hadoop-HDFS-存储">Hadoop-HDFS-存储</a><time datetime="2021-04-22T05:22:29.000Z" title="Created 2021-04-22 13:22:29">2021-04-22</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%90%8E%E7%AB%AF/"><span class="card-category-list-name">后端</span><span class="card-category-list-count">11</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/"><span class="card-category-list-name">大数据</span><span class="card-category-list-count">19</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="card-category-list-name">算法与数据结构</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%BF%90%E7%BB%B4/"><span class="card-category-list-name">运维</span><span class="card-category-list-count">7</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/Docker/" style="font-size: 1.17em; color: #999c9f">Docker</a> <a href="/tags/Guava/" style="font-size: 1.1em; color: #999">Guava</a> <a href="/tags/HBase/" style="font-size: 1.1em; color: #999">HBase</a> <a href="/tags/Hadoop/" style="font-size: 1.1em; color: #999">Hadoop</a> <a href="/tags/Hive/" style="font-size: 1.37em; color: #99a4b2">Hive</a> <a href="/tags/Java/" style="font-size: 1.3em; color: #99a1ac">Java</a> <a href="/tags/Kafka/" style="font-size: 1.23em; color: #999ea6">Kafka</a> <a href="/tags/Leetcode/" style="font-size: 1.1em; color: #999">Leetcode</a> <a href="/tags/Linux/" style="font-size: 1.17em; color: #999c9f">Linux</a> <a href="/tags/MySQL/" style="font-size: 1.43em; color: #99a6b9">MySQL</a> <a href="/tags/SQL/" style="font-size: 1.1em; color: #999">SQL</a> <a href="/tags/Scala/" style="font-size: 1.17em; color: #999c9f">Scala</a> <a href="/tags/Spark/" style="font-size: 1.5em; color: #99a9bf">Spark</a> <a href="/tags/SparkSQL/" style="font-size: 1.1em; color: #999">SparkSQL</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 1.3em; color: #99a1ac">工具</a> <a href="/tags/%E5%B9%B6%E5%8F%91/" style="font-size: 1.1em; color: #999">并发</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" style="font-size: 1.23em; color: #999ea6">数据结构与算法</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86/" style="font-size: 1.1em; color: #999">数据采集</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 1.1em; color: #999">机器学习</a> <a href="/tags/%E6%BA%90%E7%A0%81/" style="font-size: 1.17em; color: #999c9f">源码</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 1.23em; color: #999ea6">算法</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/05/"><span class="card-archive-list-date">May 2021</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/04/"><span class="card-archive-list-date">April 2021</span><span class="card-archive-list-count">20</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/03/"><span class="card-archive-list-date">March 2021</span><span class="card-archive-list-count">12</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/12/"><span class="card-archive-list-date">December 2020</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/11/"><span class="card-archive-list-date">November 2020</span><span class="card-archive-list-count">7</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">47</div></div><div class="webinfo-item"><div class="item-name">UV :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">PV :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">Last Push :</div><div class="item-count" id="last-push-date" data-lastPushDate="2021-05-07T07:54:27.459Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Janhen</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>